# Generated by Copilot
# Docker Setup for Universal Downloader

This document explains how to run the Universal Downloader API using Docker.

## Quick Start

### Option 1: Using Docker Compose (Recommended)

```bash
# Build and start the application
docker-compose up -d

# View logs
docker-compose logs -f

# Stop the application
docker-compose down
```

### Option 2: Using the Management Script

```bash
# Make the script executable (if not already done)
chmod +x docker.sh

# Build and run the container
./docker.sh run

# View logs
./docker.sh logs

# Stop the container
./docker.sh stop

# See all available commands
./docker.sh help
```

### Option 3: Using Docker Commands Directly

```bash
# Build the image
docker build -t universal-downloader .

# Run the container
docker run -d --name universal-downloader-app -p 3000:3000 universal-downloader

# View logs
docker logs -f universal-downloader-app

# Stop and remove the container
docker stop universal-downloader-app
docker rm universal-downloader-app
```

## Access the API

Once the container is running, you can access the API at:
- **Base URL**: http://localhost:3000
- **Health Check**: http://localhost:3000/

## Available Endpoints

The API provides endpoints for downloading content from various platforms:

- `/api/douyin` - Douyin/TikTok China
- `/api/linkedin` - LinkedIn
- `/api/meta` - Facebook/Instagram
- `/api/pinterest` - Pinterest
- `/api/tiktok` - TikTok
- `/api/threads` - Threads
- `/api/twitter` - Twitter/X
- `/api/reddit` - Reddit
- `/api/youtube` - YouTube

## Configuration

### Environment Variables

You can customize the application behavior using environment variables:

```bash
# Using docker run
docker run -d --name universal-downloader-app -p 3000:3000 -e PORT=8080 universal-downloader

# Using docker-compose (modify docker-compose.yml)
environment:
  - NODE_ENV=production
  - PORT=8080
```

### Port Mapping

To run on a different port, change the port mapping:

```bash
# Run on port 8080 instead of 3000
docker run -d --name universal-downloader-app -p 8080:3000 universal-downloader
```

## Troubleshooting

### Container Won't Start
```bash
# Check container logs
docker logs universal-downloader-app

# Check if port is already in use
lsof -i :3000
```

### Permission Issues
```bash
# Make sure the docker.sh script is executable
chmod +x docker.sh

# If you get permission denied errors, try running with sudo
sudo ./docker.sh run
```

### Image Build Issues
```bash
# Clean build (no cache)
docker build --no-cache -t universal-downloader .

# Clean up old images
docker image prune -f
```

## Management Commands

The `docker.sh` script provides convenient commands:

- `./docker.sh build` - Build the Docker image
- `./docker.sh run` - Start the container
- `./docker.sh stop` - Stop and remove the container
- `./docker.sh restart` - Restart the container
- `./docker.sh logs` - Show container logs
- `./docker.sh clean` - Remove container and image
- `./docker.sh help` - Show help

## Production Considerations

For production deployment:

1. **Use a reverse proxy** (nginx, Apache) in front of the container
2. **Set up proper logging** using Docker logging drivers
3. **Configure health checks** (already included in docker-compose.yml)
4. **Use environment-specific configurations**
5. **Consider using Docker Swarm or Kubernetes** for scaling

### Example with nginx reverse proxy:

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## Security Notes

- The container runs as a non-root user for security
- Only necessary files are copied (see .dockerignore)
- Production builds use `npm ci --only=production` for smaller image size
- Health checks are configured to monitor application status

## Support

If you encounter any issues with the Docker setup, please check:
1. Docker is properly installed and running
2. Port 3000 is available
3. You have sufficient disk space for the image
4. Your firewall allows connections on the specified port